<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Статистический Олимп - Final Stable</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        :root {
            --primary: #00d2ff;
            --junior: #00b894;
            --middle: #fdcb6e;
            --senior: #d63031;
            --bg: #0b0e14;
            --glass: rgba(255, 255, 255, 0.08);
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: radial-gradient(circle at top right, #1e1e2f, #0b0e14);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Предотвращает дергание при анимациях */
        }

        .card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 24px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            position: relative;
            z-index: 1;
        }

        .hidden { display: none !important; }

        h1 { text-align: center; margin-bottom: 10px; background: linear-gradient(45deg, #00d2ff, #9d50bb); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 2rem; }

        .level-select { display: flex; flex-direction: column; gap: 12px; margin-top: 20px; }

        .lvl-btn {
            padding: 18px; border-radius: 12px; border: 2px solid transparent;
            cursor: pointer; color: white; font-weight: 700; transition: all 0.2s ease;
            text-align: center; background: rgba(255,255,255,0.05);
        }

        .lvl-btn.jnr:hover { border-color: var(--junior); background: rgba(0, 184, 148, 0.1); }
        .lvl-btn.mid:hover { border-color: var(--middle); background: rgba(253, 203, 110, 0.1); }
        .lvl-btn.snr:hover { border-color: var(--senior); background: rgba(214, 48, 49, 0.1); }

        input {
            width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #333;
            background: rgba(0,0,0,0.3); color: white; margin-bottom: 15px; box-sizing: border-box;
            outline: none; font-size: 1rem;
        }

        .opt-btn {
            width: 100%; padding: 14px; margin: 8px 0; background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: white;
            text-align: left; cursor: pointer; transition: 0.2s; font-size: 1rem;
        }
        .opt-btn:hover { background: rgba(255,255,255,0.1); border-color: var(--primary); transform: translateX(5px); }

        .progress-bar { height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; margin: 20px 0; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; border-radius: 10px; transition: 0.4s cubic-bezier(0.1, 0.7, 1.0, 0.1); }

        #review-list { max-height: 380px; overflow-y: auto; margin-top: 15px; padding-right: 8px; }
        .rev-card { padding: 12px; border-radius: 10px; margin-bottom: 10px; background: rgba(0,0,0,0.2); border-left: 4px solid var(--senior); }
        .rev-card.is-ok { border-left-color: var(--junior); }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }
    </style>
</head>
<body>

    <div id="scr-start" class="card animate__animated animate__zoomIn">
        <h1>STAT-OLYMPUS</h1>
        <p style="text-align: center; opacity: 0.7; font-size: 0.9rem;">Проверьте свои знания статистики</p>
        <input type="text" id="userName" placeholder="Введите ваш никнейм..." maxlength="15">
        <div class="level-select">
            <div style="font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; color: var(--primary); margin-bottom: -5px;">Выберите сложность:</div>
            <button class="lvl-btn jnr" onclick="startGame('junior')">JUNIOR (Легко)</button>
            <button class="lvl-btn mid" onclick="startGame('middle')">MIDDLE (Средне)</button>
            <button class="lvl-btn snr" onclick="startGame('senior')">SENIOR (Сложно)</button>
        </div>
    </div>

    <div id="scr-game" class="card hidden">
        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 5px;">
            <span id="q-step">1 / 15</span>
            <span id="lvl-display" style="font-weight: bold; color: var(--primary);"></span>
        </div>
        <div class="progress-bar"><div id="bar" class="progress-fill"></div></div>
        <h2 id="question-text" style="min-height: 70px; font-size: 1.2rem; line-height: 1.4;"></h2>
        <div id="options-box"></div>
    </div>

    <div id="scr-end" class="card hidden">
        <h1 id="score-heading"></h1>
        <div id="review-list"></div>
        <button class="lvl-btn" style="width:100%; margin-top:15px; background: var(--primary); border:none;" onclick="location.reload()">ВЕРНУТЬСЯ В МЕНЮ</button>
    </div>

    <script>
        // БАЗА ДАННЫХ (45 вопросов) - Оптимизирована
        const QUESTIONS = {
            junior: [
                {q: "Размах ряда — это разница между Max и чем?", a: ["Медианой", "Минимумом", "Средним"], c: 1},
                {q: "Чему равна вероятность невозможного события?", a: ["1", "0", "0.5"], c: 1},
                {q: "Среднее арифметическое чисел 10 и 20:", a: ["15", "10", "30"], c: 0},
                {q: "Вероятность выпадения «решки»:", a: ["0.1", "0.5", "1"], c: 1},
                {q: "Событие, которое случится обязательно:", a: ["Случайное", "Достоверное", "Невозможное"], c: 1},
                {q: "Медиана ряда 1, 3, 5:", a: ["1", "3", "5"], c: 1},
                {q: "Сколько исходов при броске одной монеты?", a: ["1", "2", "4"], c: 1},
                {q: "Самое частое число в наборе данных — это:", a: ["Медиана", "Среднее", "Мода"], c: 2},
                {q: "Что такое P в формуле вероятности?", a: ["Power", "Probability", "Point"], c: 1},
                {q: "Вероятность выпадения числа 5 на кубике:", a: ["1/6", "1/2", "1/5"], c: 0},
                {q: "Какое число не может быть вероятностью?", a: ["0.5", "1.5", "0"], c: 1},
                {q: "Размах чисел 0, 5, 10 равен:", a: ["5", "10", "0"], c: 1},
                {q: "Если из 10 шаров 3 красных, вероятность вынуть красный:", a: ["0.3", "0.7", "3"], c: 0},
                {q: "Как называется наука о сборе и анализе данных?", a: ["Алгебра", "Статистика", "Геометрия"], c: 1},
                {q: "Среднее ряда 5, 5, 5:", a: ["0", "5", "15"], c: 1}
            ],
            middle: [
                {q: "Чему равно 4! ?", a: ["12", "16", "24"], c: 2},
                {q: "IQR (межквартильный размах) — это Q3 минус:", a: ["Q1", "Среднее", "Медиана"], c: 0},
                {q: "В чем измеряется дисперсия?", a: ["В исходных единицах", "В квадратах единиц", "В процентах"], c: 1},
                {q: "Чему равно 0! ?", a: ["0", "1", "Ошибка"], c: 1},
                {q: "Нижний квартиль (Q1) отсекает...", a: ["25% данных", "50% данных", "75% данных"], c: 0},
                {q: "Корень из дисперсии — это:", a: ["Размах", "Стандартное отклонение", "Медиана"], c: 1},
                {q: "Если порядок важен, мы используем:", a: ["Сочетания", "Размещения", "Сумму"], c: 1},
                {q: "В «ящике с усами» линия внутри ящика — это:", a: ["Среднее", "Медиана", "Мода"], c: 1},
                {q: "Сколько способов расставить 3 книги на полке?", a: ["3", "6", "9"], c: 1},
                {q: "IQR охватывает сколько процентов данных?", a: ["25%", "50%", "100%"], c: 1},
                {q: "Размах чисел -5 и 5 равен:", a: ["0", "5", "10"], c: 2},
                {q: "Если все числа в ряду одинаковы, дисперсия равна:", a: ["0", "1", "Среднему"], c: 0},
                {q: "Медиана ряда 2, 4, 6, 8:", a: ["4", "5", "6"], c: 1},
                {q: "Какая мера разброса чувствительна к выбросам?", a: ["Медиана", "Размах", "IQR"], c: 1},
                {q: "P(A) = 0.4. Чему равна вероятность того, что А НЕ произойдет?", a: ["0.4", "0.6", "0.5"], c: 1}
            ],
            senior: [
                {q: "Если все данные умножить на 2, станд. отклонение (σ):", a: ["Не изменится", "Увеличится в 2 раза", "Увеличится в 4 раза"], c: 1},
                {q: "Вероятность пересечения независимых событий P(A ∩ B):", a: ["P(A) + P(B)", "P(A) * P(B)", "P(A) / P(B)"], c: 1},
                {q: "Если дисперсия 0.16, чему равно σ?", a: ["0.04", "0.4", "0.8"], c: 1},
                {q: "При сильных выбросах лучше всего использовать:", a: ["Среднее", "Медиану", "Размах"], c: 1},
                {q: "Если ко всем числам прибавить 50, дисперсия:", a: ["Увеличится", "Уменьшится", "Не изменится"], c: 2},
                {q: "Коэффициент вариации — это σ деленное на:", a: ["Размах", "Среднее арифметическое", "Дисперсию"], c: 1},
                {q: "Число сочетаний из 4 по 2 равно:", a: ["6", "12", "4"], c: 0},
                {q: "Для несовместных событий вероятность суммы P(A+B) равна:", a: ["P(A)*P(B)", "P(A)+P(B)", "1"], c: 1},
                {q: "В симметричном распределении:", a: ["Mean > Median", "Mean = Median", "Mean < Median"], c: 1},
                {q: "Верхний квартиль (Q3) — это какой процентиль?", a: ["25%", "50%", "75%"], c: 2},
                {q: "Правило «трех сигм» для нормального распределения — это:", a: ["95%", "99.7%", "68%"], c: 1},
                {q: "При броске двух кубиков вероятность суммы 2:", a: ["1/6", "1/12", "1/36"], c: 2},
                {q: "Факториал 5! равен:", a: ["60", "120", "100"], c: 1},
                {q: "Дисперсия — это среднее квадратов минус:", a: ["Среднее", "Квадрат среднего", "Размах"], c: 1},
                {q: "Z-оценка показывает расстояние от среднего в единицах:", a: ["Процентов", "Стандартных отклонений", "Размаха"], c: 1}
            ]
        };

        let currentQ = [];
        let curIdx = 0;
        let score = 0;
        let log = [];

        function startGame(lvl) {
            const name = document.getElementById('userName').value.trim();
            if (!name) {
                const input = document.getElementById('userName');
                input.classList.add('animate__animated', 'animate__shakeX');
                setTimeout(() => input.classList.remove('animate__shakeX'), 500);
                return;
            }

            // Сброс состояния
            curIdx = 0;
            score = 0;
            log = [];
            currentQ = [...QUESTIONS[lvl]].sort(() => 0.5 - Math.random());

            // Переход
            switchScreen('scr-start', 'scr-game');
            document.getElementById('lvl-display').innerText = lvl.toUpperCase();
            renderQuestion();
        }

        function switchScreen(outId, inId) {
            const outEl = document.getElementById(outId);
            const inEl = document.getElementById(inId);
            outEl.classList.add('animate__animated', 'animate__fadeOut');
            setTimeout(() => {
                outEl.classList.add('hidden');
                outEl.classList.remove('animate__animated', 'animate__fadeOut');
                inEl.classList.remove('hidden');
                inEl.classList.add('animate__animated', 'animate__fadeIn');
            }, 400);
        }

        function renderQuestion() {
            const q = currentQ[curIdx];
            document.getElementById('q-step').innerText = `Вопрос ${curIdx + 1} / 15`;
            document.getElementById('question-text').innerText = q.q;
            
            const box = document.getElementById('options-box');
            box.innerHTML = '';
            
            q.a.forEach((text, i) => {
                const b = document.createElement('button');
                b.className = 'opt-btn animate__animated animate__fadeInUp';
                b.style.animationDelay = (i * 0.05) + 's';
                b.innerText = text;
                b.onclick = () => check(i);
                box.appendChild(b);
            });

            document.getElementById('bar').style.width = (curIdx / 15 * 100) + '%';
        }

        function check(idx) {
            const q = currentQ[curIdx];
            const correct = (idx === q.c);
            if (correct) score++;
            
            log.push({
                q: q.q,
                ua: q.a[idx],
                ca: q.a[q.c],
                ok: correct
            });

            curIdx++;
            if (curIdx < 15) {
                renderQuestion();
            } else {
                showFinal();
            }
        }

        function showFinal() {
            switchScreen('scr-game', 'scr-end');
            const name = document.getElementById('userName').value;
            document.getElementById('score-heading').innerText = `${name}: ${score} / 15`;
            
            const list = document.getElementById('review-list');
            list.innerHTML = '';
            
            log.forEach(item => {
                const d = document.createElement('div');
                d.className = `rev-card ${item.ok ? 'is-ok' : ''}`;
                d.innerHTML = `<strong>${item.q}</strong><br>
                ${item.ok ? `✅ ${item.ca}` : `❌ ${item.ua} <br> <span style="color:var(--junior)">✔️ Верно: ${item.ca}</span>`}`;
                list.appendChild(d);
            });
        }
    </script>
</body>
</html>